Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['length == 260.0', 'prob1 == 1644.93936463711', 'prob2 == 1684.90731085193', 'num_aligns == 10.0', "model2 == 'WAG'"]
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1152669818470780051.jar tmpDir=null
 0 b'20/06/17 16:09:39 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 16:09:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 16:09:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 16:09:40 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 16:09:40 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 16:09:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0014\n20/06/17 16:09:41 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0014\n20/06/17 16:09:41 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0014/\n20/06/17 16:09:41 INFO mapreduce.Job: Running job: job_1592405789799_0014\n20/06/17 16:09:46 INFO mapreduce.Job: Job job_1592405789799_0014 running in uber mode : false\n20/06/17 16:09:46 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 16:09:52 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 16:09:53 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 16:09:57 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 16:09:58 INFO mapreduce.Job: Job job_1592405789799_0014 completed successfully\n20/06/17 16:09:58 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6623\n\t\tTotal time spent by all reduces in occupied slots (ms)=3125\n\t\tTotal time spent by all map tasks (ms)=6623\n\t\tTotal time spent by all reduce tasks (ms)=3125\n\t\tTotal vcore-seconds taken by all map tasks=6623\n\t\tTotal vcore-seconds taken by all reduce tasks=3125\n\t\tTotal megabyte-seconds taken by all map tasks=6781952\n\t\tTotal megabyte-seconds taken by all reduce tasks=3200000\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=50\n\t\tCPU time spent (ms)=1580\n\t\tPhysical memory (bytes) snapshot=751689728\n\t\tVirtual memory (bytes) snapshot=4150386688\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 16:09:58 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['prob2 == 1283.56989953363', 'num_aligns == 10.0', 'prob1 == 1246.4621751953', 'length == 214.0', "model2 == 'WAG+I'"]
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6521654126101899228.jar tmpDir=null
 0 b'20/06/17 18:19:18 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 18:19:18 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:19:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:19:19 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 18:19:19 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 18:19:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0016\n20/06/17 18:19:19 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0016\n20/06/17 18:19:19 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0016/\n20/06/17 18:19:19 INFO mapreduce.Job: Running job: job_1592405789799_0016\n20/06/17 18:19:24 INFO mapreduce.Job: Job job_1592405789799_0016 running in uber mode : false\n20/06/17 18:19:24 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 18:19:29 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 18:19:30 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 18:19:34 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 18:19:34 INFO mapreduce.Job: Job job_1592405789799_0016 completed successfully\n20/06/17 18:19:35 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6896\n\t\tTotal time spent by all reduces in occupied slots (ms)=2729\n\t\tTotal time spent by all map tasks (ms)=6896\n\t\tTotal time spent by all reduce tasks (ms)=2729\n\t\tTotal vcore-seconds taken by all map tasks=6896\n\t\tTotal vcore-seconds taken by all reduce tasks=2729\n\t\tTotal megabyte-seconds taken by all map tasks=7061504\n\t\tTotal megabyte-seconds taken by all reduce tasks=2794496\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=62\n\t\tCPU time spent (ms)=1630\n\t\tPhysical memory (bytes) snapshot=743477248\n\t\tVirtual memory (bytes) snapshot=4138127360\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 18:19:35 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ["model2 == 'WAG+G'", 'prob2 == 1651.09950169048', 'length == 230.0', 'prob1 == 1651.09950169048', 'num_aligns == 10.0']
Preferences: ["model2 == 'WAG+G'", 'prob2 == 1651.09950169048', 'length == 230.0', 'prob1 == 1651.09950169048', 'num_aligns == 10.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob8519782607223012457.jar tmpDir=null
 0 b'20/06/17 18:24:10 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 18:24:10 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:24:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:24:11 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 18:24:11 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 18:24:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0018\n20/06/17 18:24:11 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0018\n20/06/17 18:24:11 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0018/\n20/06/17 18:24:11 INFO mapreduce.Job: Running job: job_1592405789799_0018\n20/06/17 18:24:16 INFO mapreduce.Job: Job job_1592405789799_0018 running in uber mode : false\n20/06/17 18:24:16 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 18:24:21 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 18:24:22 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 18:24:27 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 18:24:27 INFO mapreduce.Job: Job job_1592405789799_0018 completed successfully\n20/06/17 18:24:28 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6496\n\t\tTotal time spent by all reduces in occupied slots (ms)=2637\n\t\tTotal time spent by all map tasks (ms)=6496\n\t\tTotal time spent by all reduce tasks (ms)=2637\n\t\tTotal vcore-seconds taken by all map tasks=6496\n\t\tTotal vcore-seconds taken by all reduce tasks=2637\n\t\tTotal megabyte-seconds taken by all map tasks=6651904\n\t\tTotal megabyte-seconds taken by all reduce tasks=2700288\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=44\n\t\tCPU time spent (ms)=1370\n\t\tPhysical memory (bytes) snapshot=711798784\n\t\tVirtual memory (bytes) snapshot=4153741312\n\t\tTotal committed heap usage (bytes)=812646400\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 18:24:28 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob8519782607223012457.jar tmpDir=null
 0 b'20/06/17 18:24:10 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 18:24:10 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:24:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:24:11 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 18:24:11 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 18:24:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0018\n20/06/17 18:24:11 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0018\n20/06/17 18:24:11 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0018/\n20/06/17 18:24:11 INFO mapreduce.Job: Running job: job_1592405789799_0018\n20/06/17 18:24:16 INFO mapreduce.Job: Job job_1592405789799_0018 running in uber mode : false\n20/06/17 18:24:16 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 18:24:21 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 18:24:22 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 18:24:27 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 18:24:27 INFO mapreduce.Job: Job job_1592405789799_0018 completed successfully\n20/06/17 18:24:28 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6496\n\t\tTotal time spent by all reduces in occupied slots (ms)=2637\n\t\tTotal time spent by all map tasks (ms)=6496\n\t\tTotal time spent by all reduce tasks (ms)=2637\n\t\tTotal vcore-seconds taken by all map tasks=6496\n\t\tTotal vcore-seconds taken by all reduce tasks=2637\n\t\tTotal megabyte-seconds taken by all map tasks=6651904\n\t\tTotal megabyte-seconds taken by all reduce tasks=2700288\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=44\n\t\tCPU time spent (ms)=1370\n\t\tPhysical memory (bytes) snapshot=711798784\n\t\tVirtual memory (bytes) snapshot=4153741312\n\t\tTotal committed heap usage (bytes)=812646400\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 18:24:28 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 5424.50103903834', 'num_aligns == 10.0', 'length == 722.0', "model2 == 'JTT+G+F'", 'prob2 == 5425.55826717737']
Preferences: ['prob1 == 5424.50103903834', 'num_aligns == 10.0', 'length == 722.0', "model2 == 'JTT+G+F'", 'prob2 == 5425.55826717737']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6512889075492651319.jar tmpDir=null
 0 b'20/06/17 18:39:12 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 18:39:13 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:39:13 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:39:14 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 18:39:14 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 18:39:14 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0020\n20/06/17 18:39:14 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0020\n20/06/17 18:39:14 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0020/\n20/06/17 18:39:14 INFO mapreduce.Job: Running job: job_1592405789799_0020\n20/06/17 18:39:19 INFO mapreduce.Job: Job job_1592405789799_0020 running in uber mode : false\n20/06/17 18:39:19 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 18:39:24 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 18:39:25 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 18:39:29 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 18:39:30 INFO mapreduce.Job: Job job_1592405789799_0020 completed successfully\n20/06/17 18:39:30 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6600\n\t\tTotal time spent by all reduces in occupied slots (ms)=2722\n\t\tTotal time spent by all map tasks (ms)=6600\n\t\tTotal time spent by all reduce tasks (ms)=2722\n\t\tTotal vcore-seconds taken by all map tasks=6600\n\t\tTotal vcore-seconds taken by all reduce tasks=2722\n\t\tTotal megabyte-seconds taken by all map tasks=6758400\n\t\tTotal megabyte-seconds taken by all reduce tasks=2787328\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=51\n\t\tCPU time spent (ms)=1480\n\t\tPhysical memory (bytes) snapshot=751288320\n\t\tVirtual memory (bytes) snapshot=4159537152\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 18:39:30 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6512889075492651319.jar tmpDir=null
 0 b'20/06/17 18:39:12 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 18:39:13 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:39:13 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:39:14 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 18:39:14 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 18:39:14 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0020\n20/06/17 18:39:14 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0020\n20/06/17 18:39:14 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0020/\n20/06/17 18:39:14 INFO mapreduce.Job: Running job: job_1592405789799_0020\n20/06/17 18:39:19 INFO mapreduce.Job: Job job_1592405789799_0020 running in uber mode : false\n20/06/17 18:39:19 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 18:39:24 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 18:39:25 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 18:39:29 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 18:39:30 INFO mapreduce.Job: Job job_1592405789799_0020 completed successfully\n20/06/17 18:39:30 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6600\n\t\tTotal time spent by all reduces in occupied slots (ms)=2722\n\t\tTotal time spent by all map tasks (ms)=6600\n\t\tTotal time spent by all reduce tasks (ms)=2722\n\t\tTotal vcore-seconds taken by all map tasks=6600\n\t\tTotal vcore-seconds taken by all reduce tasks=2722\n\t\tTotal megabyte-seconds taken by all map tasks=6758400\n\t\tTotal megabyte-seconds taken by all reduce tasks=2787328\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=51\n\t\tCPU time spent (ms)=1480\n\t\tPhysical memory (bytes) snapshot=751288320\n\t\tVirtual memory (bytes) snapshot=4159537152\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 18:39:30 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 3877.20299959305', 'num_aligns == 10.0', 'prob2 == 3877.20299959305', "model2 == 'RtREV+G+F'", 'length == 496.0']
Preferences: ['prob1 == 3877.20299959305', 'num_aligns == 10.0', 'prob2 == 3877.20299959305', "model2 == 'RtREV+G+F'", 'length == 496.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6251743609835649799.jar tmpDir=null
 0 b'20/06/17 18:41:16 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 18:41:17 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:41:17 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:41:18 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 18:41:18 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 18:41:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0022\n20/06/17 18:41:18 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0022\n20/06/17 18:41:18 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0022/\n20/06/17 18:41:18 INFO mapreduce.Job: Running job: job_1592405789799_0022\n20/06/17 18:41:23 INFO mapreduce.Job: Job job_1592405789799_0022 running in uber mode : false\n20/06/17 18:41:23 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 18:41:29 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 18:41:30 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 18:41:36 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 18:41:36 INFO mapreduce.Job: Job job_1592405789799_0022 completed successfully\n20/06/17 18:41:36 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=7870\n\t\tTotal time spent by all reduces in occupied slots (ms)=3843\n\t\tTotal time spent by all map tasks (ms)=7870\n\t\tTotal time spent by all reduce tasks (ms)=3843\n\t\tTotal vcore-seconds taken by all map tasks=7870\n\t\tTotal vcore-seconds taken by all reduce tasks=3843\n\t\tTotal megabyte-seconds taken by all map tasks=8058880\n\t\tTotal megabyte-seconds taken by all reduce tasks=3935232\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=38\n\t\tCPU time spent (ms)=1870\n\t\tPhysical memory (bytes) snapshot=772730880\n\t\tVirtual memory (bytes) snapshot=4150517760\n\t\tTotal committed heap usage (bytes)=814743552\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 18:41:36 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6251743609835649799.jar tmpDir=null
 0 b'20/06/17 18:41:16 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 18:41:17 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:41:17 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 18:41:18 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 18:41:18 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 18:41:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0022\n20/06/17 18:41:18 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0022\n20/06/17 18:41:18 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0022/\n20/06/17 18:41:18 INFO mapreduce.Job: Running job: job_1592405789799_0022\n20/06/17 18:41:23 INFO mapreduce.Job: Job job_1592405789799_0022 running in uber mode : false\n20/06/17 18:41:23 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 18:41:29 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 18:41:30 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 18:41:36 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 18:41:36 INFO mapreduce.Job: Job job_1592405789799_0022 completed successfully\n20/06/17 18:41:36 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=7870\n\t\tTotal time spent by all reduces in occupied slots (ms)=3843\n\t\tTotal time spent by all map tasks (ms)=7870\n\t\tTotal time spent by all reduce tasks (ms)=3843\n\t\tTotal vcore-seconds taken by all map tasks=7870\n\t\tTotal vcore-seconds taken by all reduce tasks=3843\n\t\tTotal megabyte-seconds taken by all map tasks=8058880\n\t\tTotal megabyte-seconds taken by all reduce tasks=3935232\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=38\n\t\tCPU time spent (ms)=1870\n\t\tPhysical memory (bytes) snapshot=772730880\n\t\tVirtual memory (bytes) snapshot=4150517760\n\t\tTotal committed heap usage (bytes)=814743552\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 18:41:36 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: (["model2 == 'RtREV+G+F'", 'prob2 == 3877.20299959305', 'length == 496.0', 'num_aligns == 10.0', 'prob1 == 3877.20299959305'], [{181: 'RtREV+G+F'}])
Preferences: (["model2 == 'RtREV+G+F'", 'prob2 == 3877.20299959305', 'length == 496.0', 'num_aligns == 10.0', 'prob1 == 3877.20299959305'], [{181: 'RtREV+G+F'}])
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ["model2 == 'WAG+I'", 'num_aligns == 10.0', 'length == 214.0', 'prob2 == 1283.56989953363', 'prob1 == 1246.4621751953']
Preferences: ["model2 == 'WAG+I'", 'num_aligns == 10.0', 'length == 214.0', 'prob2 == 1283.56989953363', 'prob1 == 1246.4621751953']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 2478.38696468583', 'num_aligns == 10.0', "model2 == 'WAG+G'", 'prob1 == 2451.42361385441', 'length == 277.0']
Preferences: ['prob2 == 2478.38696468583', 'num_aligns == 10.0', "model2 == 'WAG+G'", 'prob1 == 2451.42361385441', 'length == 277.0']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['length == 237.0', 'prob1 == 1588.4588012017', 'num_aligns == 10.0', "model2 == 'WAG+G'", 'prob2 == 1588.4588012017']
Preferences: ['length == 237.0', 'prob1 == 1588.4588012017', 'num_aligns == 10.0', "model2 == 'WAG+G'", 'prob2 == 1588.4588012017']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1588.4588012017', 'length == 237.0', "model2 == 'WAG+G'", 'num_aligns == 10.0', 'prob1 == 1588.4588012017']
Preferences: ['prob2 == 1588.4588012017', 'length == 237.0', "model2 == 'WAG+G'", 'num_aligns == 10.0', 'prob1 == 1588.4588012017']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob29360534791118523.jar tmpDir=null
 1 b'20/06/17 19:37:02 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:37:03 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:37:03 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:37:04 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:37:04 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:37:04 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0028\n20/06/17 19:37:04 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0028\n20/06/17 19:37:04 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0028/\n20/06/17 19:37:04 INFO mapreduce.Job: Running job: job_1592405789799_0028\n20/06/17 19:37:09 INFO mapreduce.Job: Job job_1592405789799_0028 running in uber mode : false\n20/06/17 19:37:09 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:37:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:18 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:20 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:24 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:26 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:31 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:37:31 INFO mapreduce.Job: Job job_1592405789799_0028 failed with state FAILED due to: Task failed task_1592405789799_0028_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:37:31 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=26922\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=26922\n\t\tTotal vcore-seconds taken by all map tasks=26922\n\t\tTotal megabyte-seconds taken by all map tasks=27568128\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:37:31 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob29360534791118523.jar tmpDir=null
 1 b'20/06/17 19:37:02 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:37:03 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:37:03 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:37:04 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:37:04 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:37:04 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0028\n20/06/17 19:37:04 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0028\n20/06/17 19:37:04 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0028/\n20/06/17 19:37:04 INFO mapreduce.Job: Running job: job_1592405789799_0028\n20/06/17 19:37:09 INFO mapreduce.Job: Job job_1592405789799_0028 running in uber mode : false\n20/06/17 19:37:09 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:37:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:18 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:20 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:24 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:26 INFO mapreduce.Job: Task Id : attempt_1592405789799_0028_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:37:31 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:37:31 INFO mapreduce.Job: Job job_1592405789799_0028 failed with state FAILED due to: Task failed task_1592405789799_0028_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:37:31 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=26922\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=26922\n\t\tTotal vcore-seconds taken by all map tasks=26922\n\t\tTotal megabyte-seconds taken by all map tasks=27568128\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:37:31 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 5610.22322493963', 'prob1 == 5563.09416521659', "model2 == 'BLOSUM62+I'", 'length == 741.0', 'num_aligns == 10.0']
Preferences: ['prob2 == 5610.22322493963', 'prob1 == 5563.09416521659', "model2 == 'BLOSUM62+I'", 'length == 741.0', 'num_aligns == 10.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1817094370592883800.jar tmpDir=null
 1 b'20/06/17 19:40:01 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:40:02 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:40:02 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:40:02 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:40:02 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:40:02 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0030\n20/06/17 19:40:02 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0030\n20/06/17 19:40:02 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0030/\n20/06/17 19:40:02 INFO mapreduce.Job: Running job: job_1592405789799_0030\n20/06/17 19:40:06 INFO mapreduce.Job: Job job_1592405789799_0030 running in uber mode : false\n20/06/17 19:40:06 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:40:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:17 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:18 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:23 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:24 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:29 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:40:29 INFO mapreduce.Job: Job job_1592405789799_0030 failed with state FAILED due to: Task failed task_1592405789799_0030_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:40:29 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=26361\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=26361\n\t\tTotal vcore-seconds taken by all map tasks=26361\n\t\tTotal megabyte-seconds taken by all map tasks=26993664\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:40:29 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1817094370592883800.jar tmpDir=null
 1 b'20/06/17 19:40:01 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:40:02 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:40:02 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:40:02 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:40:02 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:40:02 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0030\n20/06/17 19:40:02 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0030\n20/06/17 19:40:02 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0030/\n20/06/17 19:40:02 INFO mapreduce.Job: Running job: job_1592405789799_0030\n20/06/17 19:40:06 INFO mapreduce.Job: Job job_1592405789799_0030 running in uber mode : false\n20/06/17 19:40:06 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:40:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:17 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:18 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:23 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:24 INFO mapreduce.Job: Task Id : attempt_1592405789799_0030_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:40:29 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:40:29 INFO mapreduce.Job: Job job_1592405789799_0030 failed with state FAILED due to: Task failed task_1592405789799_0030_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:40:29 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=26361\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=26361\n\t\tTotal vcore-seconds taken by all map tasks=26361\n\t\tTotal megabyte-seconds taken by all map tasks=26993664\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:40:29 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 2052.86464998793', "model2 == 'WAG+I'", 'length == 339.0', 'num_aligns == 11.0', 'prob1 == 2012.68124743812']
Preferences: ['prob2 == 2052.86464998793', "model2 == 'WAG+I'", 'length == 339.0', 'num_aligns == 11.0', 'prob1 == 2012.68124743812']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob7025359619540435587.jar tmpDir=null
 1 b'20/06/17 19:42:10 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:42:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:42:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:42:11 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:42:11 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:42:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0032\n20/06/17 19:42:12 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0032\n20/06/17 19:42:12 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0032/\n20/06/17 19:42:12 INFO mapreduce.Job: Running job: job_1592405789799_0032\n20/06/17 19:42:17 INFO mapreduce.Job: Job job_1592405789799_0032 running in uber mode : false\n20/06/17 19:42:17 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:42:21 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:22 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:26 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:27 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:32 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:33 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:38 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:42:38 INFO mapreduce.Job: Job job_1592405789799_0032 failed with state FAILED due to: Task failed task_1592405789799_0032_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:42:38 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25000\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25000\n\t\tTotal vcore-seconds taken by all map tasks=25000\n\t\tTotal megabyte-seconds taken by all map tasks=25600000\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:42:38 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob7025359619540435587.jar tmpDir=null
 1 b'20/06/17 19:42:10 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:42:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:42:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:42:11 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:42:11 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:42:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0032\n20/06/17 19:42:12 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0032\n20/06/17 19:42:12 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0032/\n20/06/17 19:42:12 INFO mapreduce.Job: Running job: job_1592405789799_0032\n20/06/17 19:42:17 INFO mapreduce.Job: Job job_1592405789799_0032 running in uber mode : false\n20/06/17 19:42:17 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:42:21 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:22 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:26 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:27 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:32 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:33 INFO mapreduce.Job: Task Id : attempt_1592405789799_0032_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:42:38 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:42:38 INFO mapreduce.Job: Job job_1592405789799_0032 failed with state FAILED due to: Task failed task_1592405789799_0032_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:42:38 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25000\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25000\n\t\tTotal vcore-seconds taken by all map tasks=25000\n\t\tTotal megabyte-seconds taken by all map tasks=25600000\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:42:38 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1588.4588012017', 'prob1 == 1588.4588012017', 'num_aligns == 10.0', "model2 == 'WAG+G'", 'length == 237.0']
Preferences: ['prob2 == 1588.4588012017', 'prob1 == 1588.4588012017', 'num_aligns == 10.0', "model2 == 'WAG+G'", 'length == 237.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob703395014611334802.jar tmpDir=null
 1 b'20/06/17 19:45:36 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:45:36 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:45:37 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:45:37 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:45:37 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:45:37 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0034\n20/06/17 19:45:37 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0034\n20/06/17 19:45:37 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0034/\n20/06/17 19:45:37 INFO mapreduce.Job: Running job: job_1592405789799_0034\n20/06/17 19:45:42 INFO mapreduce.Job: Job job_1592405789799_0034 running in uber mode : false\n20/06/17 19:45:42 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:45:46 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:47 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:51 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:52 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:59 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:46:04 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:46:04 INFO mapreduce.Job: Job job_1592405789799_0034 failed with state FAILED due to: Task failed task_1592405789799_0034_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:46:04 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25902\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25902\n\t\tTotal vcore-seconds taken by all map tasks=25902\n\t\tTotal megabyte-seconds taken by all map tasks=26523648\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:46:04 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob703395014611334802.jar tmpDir=null
 1 b'20/06/17 19:45:36 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:45:36 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:45:37 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:45:37 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:45:37 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:45:37 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0034\n20/06/17 19:45:37 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0034\n20/06/17 19:45:37 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0034/\n20/06/17 19:45:37 INFO mapreduce.Job: Running job: job_1592405789799_0034\n20/06/17 19:45:42 INFO mapreduce.Job: Job job_1592405789799_0034 running in uber mode : false\n20/06/17 19:45:42 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:45:46 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:47 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:51 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:52 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:45:59 INFO mapreduce.Job: Task Id : attempt_1592405789799_0034_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:46:04 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:46:04 INFO mapreduce.Job: Job job_1592405789799_0034 failed with state FAILED due to: Task failed task_1592405789799_0034_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:46:04 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25902\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25902\n\t\tTotal vcore-seconds taken by all map tasks=25902\n\t\tTotal megabyte-seconds taken by all map tasks=26523648\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:46:04 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
MAPPER
MAPPER
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['num_aligns == 10.0', "model2 == 'RtREV+G'", 'length == 159.0', 'prob1 == 1123.66070728824', 'prob2 == 1123.66070728824']
Preferences: ['num_aligns == 10.0', "model2 == 'RtREV+G'", 'length == 159.0', 'prob1 == 1123.66070728824', 'prob2 == 1123.66070728824']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob8262632559086135152.jar tmpDir=null
 1 b'20/06/17 19:55:33 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:55:34 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:55:34 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:55:34 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:55:34 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:55:34 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0036\n20/06/17 19:55:35 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0036\n20/06/17 19:55:35 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0036/\n20/06/17 19:55:35 INFO mapreduce.Job: Running job: job_1592405789799_0036\n20/06/17 19:55:40 INFO mapreduce.Job: Job job_1592405789799_0036 running in uber mode : false\n20/06/17 19:55:40 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:55:44 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:45 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:49 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:50 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:55 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:56 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:56:01 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:56:01 INFO mapreduce.Job: Job job_1592405789799_0036 failed with state FAILED due to: Task failed task_1592405789799_0036_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:56:01 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25079\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25079\n\t\tTotal vcore-seconds taken by all map tasks=25079\n\t\tTotal megabyte-seconds taken by all map tasks=25680896\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:56:01 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob8262632559086135152.jar tmpDir=null
 1 b'20/06/17 19:55:33 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:55:34 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:55:34 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:55:34 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 19:55:34 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 19:55:34 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0036\n20/06/17 19:55:35 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0036\n20/06/17 19:55:35 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0036/\n20/06/17 19:55:35 INFO mapreduce.Job: Running job: job_1592405789799_0036\n20/06/17 19:55:40 INFO mapreduce.Job: Job job_1592405789799_0036 running in uber mode : false\n20/06/17 19:55:40 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 19:55:44 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:45 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:49 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:50 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:55 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:55:56 INFO mapreduce.Job: Task Id : attempt_1592405789799_0036_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 19:56:01 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 19:56:01 INFO mapreduce.Job: Job job_1592405789799_0036 failed with state FAILED due to: Task failed task_1592405789799_0036_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 19:56:01 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25079\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25079\n\t\tTotal vcore-seconds taken by all map tasks=25079\n\t\tTotal megabyte-seconds taken by all map tasks=25680896\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 19:56:01 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob7116588919639411707.jar tmpDir=null
 5 b'20/06/17 19:59:52 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:59:52 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:59:53 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:59:53 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/06/17 19:59:53 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/06/17 19:59:53 ERROR streaming.StreamJob: Error Launching job : Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob7116588919639411707.jar tmpDir=null
 5 b'20/06/17 19:59:52 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 19:59:52 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:59:53 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 19:59:53 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/06/17 19:59:53 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/06/17 19:59:53 ERROR streaming.StreamJob: Error Launching job : Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob3486027345533841687.jar tmpDir=null
 1 b'20/06/17 20:00:35 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:00:35 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:00:35 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:00:36 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:00:36 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:00:36 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0037\n20/06/17 20:00:36 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0037\n20/06/17 20:00:36 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0037/\n20/06/17 20:00:36 INFO mapreduce.Job: Running job: job_1592405789799_0037\n20/06/17 20:00:41 INFO mapreduce.Job: Job job_1592405789799_0037 running in uber mode : false\n20/06/17 20:00:41 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:00:45 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:47 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:50 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:51 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:56 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:01:03 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:01:03 INFO mapreduce.Job: Job job_1592405789799_0037 failed with state FAILED due to: Task failed task_1592405789799_0037_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:01:03 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25903\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25903\n\t\tTotal vcore-seconds taken by all map tasks=25903\n\t\tTotal megabyte-seconds taken by all map tasks=26524672\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:01:03 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob3486027345533841687.jar tmpDir=null
 1 b'20/06/17 20:00:35 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:00:35 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:00:35 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:00:36 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:00:36 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:00:36 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0037\n20/06/17 20:00:36 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0037\n20/06/17 20:00:36 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0037/\n20/06/17 20:00:36 INFO mapreduce.Job: Running job: job_1592405789799_0037\n20/06/17 20:00:41 INFO mapreduce.Job: Job job_1592405789799_0037 running in uber mode : false\n20/06/17 20:00:41 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:00:45 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:47 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:50 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:51 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:56 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:00:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0037_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:01:03 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:01:03 INFO mapreduce.Job: Job job_1592405789799_0037 failed with state FAILED due to: Task failed task_1592405789799_0037_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:01:03 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25903\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25903\n\t\tTotal vcore-seconds taken by all map tasks=25903\n\t\tTotal megabyte-seconds taken by all map tasks=26524672\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:01:03 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1702085042212098509.jar tmpDir=null
 1 b'20/06/17 20:02:18 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:02:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:02:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:02:20 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:02:20 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:02:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0038\n20/06/17 20:02:20 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0038\n20/06/17 20:02:20 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0038/\n20/06/17 20:02:20 INFO mapreduce.Job: Running job: job_1592405789799_0038\n20/06/17 20:02:25 INFO mapreduce.Job: Job job_1592405789799_0038 running in uber mode : false\n20/06/17 20:02:25 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:02:29 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:30 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:34 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:35 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:40 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:41 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:46 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:02:46 INFO mapreduce.Job: Job job_1592405789799_0038 failed with state FAILED due to: Task failed task_1592405789799_0038_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:02:46 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25021\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25021\n\t\tTotal vcore-seconds taken by all map tasks=25021\n\t\tTotal megabyte-seconds taken by all map tasks=25621504\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:02:46 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1702085042212098509.jar tmpDir=null
 1 b'20/06/17 20:02:18 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:02:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:02:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:02:20 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:02:20 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:02:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0038\n20/06/17 20:02:20 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0038\n20/06/17 20:02:20 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0038/\n20/06/17 20:02:20 INFO mapreduce.Job: Running job: job_1592405789799_0038\n20/06/17 20:02:25 INFO mapreduce.Job: Job job_1592405789799_0038 running in uber mode : false\n20/06/17 20:02:25 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:02:29 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:30 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:34 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:35 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:40 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:41 INFO mapreduce.Job: Task Id : attempt_1592405789799_0038_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:02:46 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:02:46 INFO mapreduce.Job: Job job_1592405789799_0038 failed with state FAILED due to: Task failed task_1592405789799_0038_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:02:46 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25021\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25021\n\t\tTotal vcore-seconds taken by all map tasks=25021\n\t\tTotal megabyte-seconds taken by all map tasks=25621504\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:02:46 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob2561913306063353639.jar tmpDir=null
 1 b'20/06/17 20:17:53 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:17:54 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:17:54 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:17:54 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:17:54 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:17:54 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0039\n20/06/17 20:17:54 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0039\n20/06/17 20:17:54 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0039/\n20/06/17 20:17:54 INFO mapreduce.Job: Running job: job_1592405789799_0039\n20/06/17 20:17:59 INFO mapreduce.Job: Job job_1592405789799_0039 running in uber mode : false\n20/06/17 20:17:59 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:18:04 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:10 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:21 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:18:21 INFO mapreduce.Job: Job job_1592405789799_0039 failed with state FAILED due to: Task failed task_1592405789799_0039_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:18:21 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=24913\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=24913\n\t\tTotal vcore-seconds taken by all map tasks=24913\n\t\tTotal megabyte-seconds taken by all map tasks=25510912\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:18:21 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob2561913306063353639.jar tmpDir=null
 1 b'20/06/17 20:17:53 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:17:54 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:17:54 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:17:54 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:17:54 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:17:54 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0039\n20/06/17 20:17:54 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0039\n20/06/17 20:17:54 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0039/\n20/06/17 20:17:54 INFO mapreduce.Job: Running job: job_1592405789799_0039\n20/06/17 20:17:59 INFO mapreduce.Job: Job job_1592405789799_0039 running in uber mode : false\n20/06/17 20:17:59 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:18:04 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:10 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0039_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:18:21 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:18:21 INFO mapreduce.Job: Job job_1592405789799_0039 failed with state FAILED due to: Task failed task_1592405789799_0039_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:18:21 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=24913\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=24913\n\t\tTotal vcore-seconds taken by all map tasks=24913\n\t\tTotal megabyte-seconds taken by all map tasks=25510912\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:18:21 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['prob1 == 2011.16377725091', 'length == 306.0', "model2 == 'WAG+G'", 'num_aligns == 10.0', 'prob2 == 2040.80899344162']
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6097013362139548651.jar tmpDir=null
 1 b'20/06/17 20:20:31 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:20:32 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:20:32 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:20:32 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:20:32 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:20:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0042\n20/06/17 20:20:33 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0042\n20/06/17 20:20:33 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0042/\n20/06/17 20:20:33 INFO mapreduce.Job: Running job: job_1592405789799_0042\n20/06/17 20:20:38 INFO mapreduce.Job: Job job_1592405789799_0042 running in uber mode : false\n20/06/17 20:20:38 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:20:42 INFO mapreduce.Job: Task Id : attempt_1592405789799_0042_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:20:43 INFO mapreduce.Job: Task Id : attempt_1592405789799_0042_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:20:47 INFO mapreduce.Job: Task Id : attempt_1592405789799_0042_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:20:49 INFO mapreduce.Job: Task Id : attempt_1592405789799_0042_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:20:54 INFO mapreduce.Job: Task Id : attempt_1592405789799_0042_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:20:55 INFO mapreduce.Job: Task Id : attempt_1592405789799_0042_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:21:01 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:21:01 INFO mapreduce.Job: Job job_1592405789799_0042 failed with state FAILED due to: Task failed task_1592405789799_0042_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:21:01 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=31278\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=31278\n\t\tTotal vcore-seconds taken by all map tasks=31278\n\t\tTotal megabyte-seconds taken by all map tasks=32028672\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:21:01 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1684.90731085193', 'length == 260.0', 'num_aligns == 10.0', 'prob1 == 1644.93936463711', "model2 == 'WAG'"]
Preferences: ['prob2 == 1684.90731085193', 'length == 260.0', 'num_aligns == 10.0', 'prob1 == 1644.93936463711', "model2 == 'WAG'"]
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob2755967461692306738.jar tmpDir=null
 1 b'20/06/17 20:22:49 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:22:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:22:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:22:51 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:22:51 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:22:51 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0044\n20/06/17 20:22:51 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0044\n20/06/17 20:22:51 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0044/\n20/06/17 20:22:51 INFO mapreduce.Job: Running job: job_1592405789799_0044\n20/06/17 20:22:56 INFO mapreduce.Job: Job job_1592405789799_0044 running in uber mode : false\n20/06/17 20:22:56 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:23:01 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:02 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:06 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:07 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:18 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:23:18 INFO mapreduce.Job: Job job_1592405789799_0044 failed with state FAILED due to: Task failed task_1592405789799_0044_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:23:18 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=27570\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=27570\n\t\tTotal vcore-seconds taken by all map tasks=27570\n\t\tTotal megabyte-seconds taken by all map tasks=28231680\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:23:18 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob2755967461692306738.jar tmpDir=null
 1 b'20/06/17 20:22:49 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:22:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:22:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:22:51 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:22:51 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:22:51 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0044\n20/06/17 20:22:51 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0044\n20/06/17 20:22:51 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0044/\n20/06/17 20:22:51 INFO mapreduce.Job: Running job: job_1592405789799_0044\n20/06/17 20:22:56 INFO mapreduce.Job: Job job_1592405789799_0044 running in uber mode : false\n20/06/17 20:22:56 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:23:01 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:02 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:06 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:07 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0044_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:23:18 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:23:18 INFO mapreduce.Job: Job job_1592405789799_0044 failed with state FAILED due to: Task failed task_1592405789799_0044_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:23:18 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=27570\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=27570\n\t\tTotal vcore-seconds taken by all map tasks=27570\n\t\tTotal megabyte-seconds taken by all map tasks=28231680\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:23:18 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['num_aligns == 10.0', 'length == 214.0', "model2 == 'WAG+I'", 'prob2 == 1283.56989953363', 'prob1 == 1246.4621751953']
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6367654118050057545.jar tmpDir=null
 1 b'20/06/17 20:25:03 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:25:04 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:25:04 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:25:04 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:25:04 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:25:04 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0046\n20/06/17 20:25:05 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0046\n20/06/17 20:25:05 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0046/\n20/06/17 20:25:05 INFO mapreduce.Job: Running job: job_1592405789799_0046\n20/06/17 20:25:10 INFO mapreduce.Job: Job job_1592405789799_0046 running in uber mode : false\n20/06/17 20:25:10 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:25:14 INFO mapreduce.Job: Task Id : attempt_1592405789799_0046_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:25:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0046_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:25:19 INFO mapreduce.Job: Task Id : attempt_1592405789799_0046_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:25:20 INFO mapreduce.Job: Task Id : attempt_1592405789799_0046_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:25:25 INFO mapreduce.Job: Task Id : attempt_1592405789799_0046_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:25:26 INFO mapreduce.Job: Task Id : attempt_1592405789799_0046_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:25:31 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:25:31 INFO mapreduce.Job: Job job_1592405789799_0046 failed with state FAILED due to: Task failed task_1592405789799_0046_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:25:31 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=24707\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=24707\n\t\tTotal vcore-seconds taken by all map tasks=24707\n\t\tTotal megabyte-seconds taken by all map tasks=25299968\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:25:31 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['prob1 == 2012.68124743812', 'num_aligns == 11.0', 'prob2 == 2052.86464998793', 'length == 339.0', "model2 == 'WAG+I'"]
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6077040681440435223.jar tmpDir=null
 0 b'20/06/17 20:26:06 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:26:07 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:26:07 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:26:08 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:26:08 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:26:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0048\n20/06/17 20:26:08 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0048\n20/06/17 20:26:08 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0048/\n20/06/17 20:26:08 INFO mapreduce.Job: Running job: job_1592405789799_0048\n20/06/17 20:26:13 INFO mapreduce.Job: Job job_1592405789799_0048 running in uber mode : false\n20/06/17 20:26:13 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:26:18 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 20:26:19 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 20:26:24 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:26:24 INFO mapreduce.Job: Job job_1592405789799_0048 completed successfully\n20/06/17 20:26:24 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=7968\n\t\tFILE: Number of bytes written=367241\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=12617\n\t\tHDFS: Number of bytes written=7728\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6488\n\t\tTotal time spent by all reduces in occupied slots (ms)=2658\n\t\tTotal time spent by all map tasks (ms)=6488\n\t\tTotal time spent by all reduce tasks (ms)=2658\n\t\tTotal vcore-seconds taken by all map tasks=6488\n\t\tTotal vcore-seconds taken by all reduce tasks=2658\n\t\tTotal megabyte-seconds taken by all map tasks=6643712\n\t\tTotal megabyte-seconds taken by all reduce tasks=2721792\n\tMap-Reduce Framework\n\t\tMap input records=117\n\t\tMap output records=117\n\t\tMap output bytes=7728\n\t\tMap output materialized bytes=7974\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=41\n\t\tReduce shuffle bytes=7974\n\t\tReduce input records=117\n\t\tReduce output records=117\n\t\tSpilled Records=234\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=44\n\t\tCPU time spent (ms)=1410\n\t\tPhysical memory (bytes) snapshot=746229760\n\t\tVirtual memory (bytes) snapshot=4154134528\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=12387\n\tFile Output Format Counters \n\t\tBytes Written=7728\n20/06/17 20:26:24 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 3459.05616179853', 'length == 418.0', "model2 == 'BLOSUM62+G'", 'prob2 == 3480.35138942569', 'num_aligns == 10.0']
Preferences: ['prob1 == 3459.05616179853', 'length == 418.0', "model2 == 'BLOSUM62+G'", 'prob2 == 3480.35138942569', 'num_aligns == 10.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6553027770919140946.jar tmpDir=null
 1 b'20/06/17 20:28:55 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:28:56 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:28:56 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:28:57 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:28:57 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:28:57 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0050\n20/06/17 20:28:57 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0050\n20/06/17 20:28:57 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0050/\n20/06/17 20:28:57 INFO mapreduce.Job: Running job: job_1592405789799_0050\n20/06/17 20:29:01 INFO mapreduce.Job: Job job_1592405789799_0050 running in uber mode : false\n20/06/17 20:29:01 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:29:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:07 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:10 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:17 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:22 INFO mapreduce.Job:  map 50% reduce 100%\n20/06/17 20:29:23 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:29:23 INFO mapreduce.Job: Job job_1592405789799_0050 failed with state FAILED due to: Task failed task_1592405789799_0050_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:29:23 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=24587\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=24587\n\t\tTotal vcore-seconds taken by all map tasks=24587\n\t\tTotal megabyte-seconds taken by all map tasks=25177088\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:29:23 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6553027770919140946.jar tmpDir=null
 1 b'20/06/17 20:28:55 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:28:56 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:28:56 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:28:57 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:28:57 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:28:57 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0050\n20/06/17 20:28:57 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0050\n20/06/17 20:28:57 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0050/\n20/06/17 20:28:57 INFO mapreduce.Job: Running job: job_1592405789799_0050\n20/06/17 20:29:01 INFO mapreduce.Job: Job job_1592405789799_0050 running in uber mode : false\n20/06/17 20:29:01 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:29:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:07 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:10 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:17 INFO mapreduce.Job: Task Id : attempt_1592405789799_0050_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 20:29:22 INFO mapreduce.Job:  map 50% reduce 100%\n20/06/17 20:29:23 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:29:23 INFO mapreduce.Job: Job job_1592405789799_0050 failed with state FAILED due to: Task failed task_1592405789799_0050_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 20:29:23 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=24587\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=24587\n\t\tTotal vcore-seconds taken by all map tasks=24587\n\t\tTotal megabyte-seconds taken by all map tasks=25177088\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 20:29:23 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 3909.45193067149', 'num_aligns == 10.0', 'length == 643.0', "model2 == 'RtREV+G+F'", 'prob1 == 3909.45193067149']
Preferences: ['prob2 == 3909.45193067149', 'num_aligns == 10.0', 'length == 643.0', "model2 == 'RtREV+G+F'", 'prob1 == 3909.45193067149']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob3247352496105156602.jar tmpDir=null
 0 b'20/06/17 20:30:13 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:30:14 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:30:14 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:30:15 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:30:15 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:30:15 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0052\n20/06/17 20:30:15 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0052\n20/06/17 20:30:15 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0052/\n20/06/17 20:30:15 INFO mapreduce.Job: Running job: job_1592405789799_0052\n20/06/17 20:30:20 INFO mapreduce.Job: Job job_1592405789799_0052 running in uber mode : false\n20/06/17 20:30:20 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:30:29 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 20:30:30 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 20:30:34 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:30:34 INFO mapreduce.Job: Job job_1592405789799_0052 completed successfully\n20/06/17 20:30:34 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=6\n\t\tFILE: Number of bytes written=351317\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=9229\n\t\tHDFS: Number of bytes written=0\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=14129\n\t\tTotal time spent by all reduces in occupied slots (ms)=3089\n\t\tTotal time spent by all map tasks (ms)=14129\n\t\tTotal time spent by all reduce tasks (ms)=3089\n\t\tTotal vcore-seconds taken by all map tasks=14129\n\t\tTotal vcore-seconds taken by all reduce tasks=3089\n\t\tTotal megabyte-seconds taken by all map tasks=14468096\n\t\tTotal megabyte-seconds taken by all reduce tasks=3163136\n\tMap-Reduce Framework\n\t\tMap input records=21\n\t\tMap output records=0\n\t\tMap output bytes=0\n\t\tMap output materialized bytes=12\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=0\n\t\tReduce shuffle bytes=12\n\t\tReduce input records=0\n\t\tReduce output records=0\n\t\tSpilled Records=0\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=49\n\t\tCPU time spent (ms)=1310\n\t\tPhysical memory (bytes) snapshot=740823040\n\t\tVirtual memory (bytes) snapshot=4151762944\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=8999\n\tFile Output Format Counters \n\t\tBytes Written=0\n20/06/17 20:30:34 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob3247352496105156602.jar tmpDir=null
 0 b'20/06/17 20:30:13 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 20:30:14 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:30:14 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 20:30:15 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 20:30:15 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 20:30:15 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0052\n20/06/17 20:30:15 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0052\n20/06/17 20:30:15 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0052/\n20/06/17 20:30:15 INFO mapreduce.Job: Running job: job_1592405789799_0052\n20/06/17 20:30:20 INFO mapreduce.Job: Job job_1592405789799_0052 running in uber mode : false\n20/06/17 20:30:20 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 20:30:29 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 20:30:30 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 20:30:34 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 20:30:34 INFO mapreduce.Job: Job job_1592405789799_0052 completed successfully\n20/06/17 20:30:34 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=6\n\t\tFILE: Number of bytes written=351317\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=9229\n\t\tHDFS: Number of bytes written=0\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=14129\n\t\tTotal time spent by all reduces in occupied slots (ms)=3089\n\t\tTotal time spent by all map tasks (ms)=14129\n\t\tTotal time spent by all reduce tasks (ms)=3089\n\t\tTotal vcore-seconds taken by all map tasks=14129\n\t\tTotal vcore-seconds taken by all reduce tasks=3089\n\t\tTotal megabyte-seconds taken by all map tasks=14468096\n\t\tTotal megabyte-seconds taken by all reduce tasks=3163136\n\tMap-Reduce Framework\n\t\tMap input records=21\n\t\tMap output records=0\n\t\tMap output bytes=0\n\t\tMap output materialized bytes=12\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=0\n\t\tReduce shuffle bytes=12\n\t\tReduce input records=0\n\t\tReduce output records=0\n\t\tSpilled Records=0\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=49\n\t\tCPU time spent (ms)=1310\n\t\tPhysical memory (bytes) snapshot=740823040\n\t\tVirtual memory (bytes) snapshot=4151762944\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=8999\n\tFile Output Format Counters \n\t\tBytes Written=0\n20/06/17 20:30:34 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['length == 496.0', 'prob2 == 3877.20299959305', 'prob1 == 3877.20299959305', "model2 == 'RtREV+G+F'", 'num_aligns == 10.0']
Preferences: ['length == 496.0', 'prob2 == 3877.20299959305', 'prob1 == 3877.20299959305', "model2 == 'RtREV+G+F'", 'num_aligns == 10.0']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 1588.4588012017', 'length == 237.0', "model2 == 'WAG+G'", 'num_aligns == 10.0', 'prob2 == 1588.4588012017']
Preferences: ['prob1 == 1588.4588012017', 'length == 237.0', "model2 == 'WAG+G'", 'num_aligns == 10.0', 'prob2 == 1588.4588012017']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ["model2 == 'WAG+I+F'", 'length == 854.0', 'num_aligns == 10.0', 'prob1 == 4634.24245902788', 'prob2 == 4634.24245902788']
Preferences: ["model2 == 'WAG+I+F'", 'length == 854.0', 'num_aligns == 10.0', 'prob1 == 4634.24245902788', 'prob2 == 4634.24245902788']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ["model2 == 'WAG+I'", 'prob2 == 2043.32403653823', 'length == 233.0', 'num_aligns == 10.0', 'prob1 == 2043.32403653823']
Preferences: ["model2 == 'WAG+I'", 'prob2 == 2043.32403653823', 'length == 233.0', 'num_aligns == 10.0', 'prob1 == 2043.32403653823']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 4634.24245902788', 'num_aligns == 10.0', 'prob2 == 4634.24245902788', "model2 == 'WAG+I+F'", 'length == 854.0']
Preferences: ['prob1 == 4634.24245902788', 'num_aligns == 10.0', 'prob2 == 4634.24245902788', "model2 == 'WAG+I+F'", 'length == 854.0']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['length == 157.0', 'prob1 == 1047.52930922224', 'prob2 == 1078.38963422709', 'num_aligns == 10.0', "model2 == 'WAG'"]
Preferences: ['length == 157.0', 'prob1 == 1047.52930922224', 'prob2 == 1078.38963422709', 'num_aligns == 10.0', "model2 == 'WAG'"]
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ["model2 == 'WAG+I'", 'prob1 == 1925.42071729315', 'length == 248.0', 'prob2 == 1925.42071729315', 'num_aligns == 10.0']
Preferences: ["model2 == 'WAG+I'", 'prob1 == 1925.42071729315', 'length == 248.0', 'prob2 == 1925.42071729315', 'num_aligns == 10.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1331505719139198713.jar tmpDir=null
 1 b'20/06/17 21:18:26 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:18:27 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:18:27 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:18:27 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:18:27 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:18:27 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0067\n20/06/17 21:18:27 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0067\n20/06/17 21:18:27 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0067/\n20/06/17 21:18:27 INFO mapreduce.Job: Running job: job_1592405789799_0067\n20/06/17 21:18:32 INFO mapreduce.Job: Job job_1592405789799_0067 running in uber mode : false\n20/06/17 21:18:32 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:18:37 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:38 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:42 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:43 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:48 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:49 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:54 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:18:54 INFO mapreduce.Job: Job job_1592405789799_0067 failed with state FAILED due to: Task failed task_1592405789799_0067_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:18:54 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25585\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25585\n\t\tTotal vcore-seconds taken by all map tasks=25585\n\t\tTotal megabyte-seconds taken by all map tasks=26199040\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:18:54 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1331505719139198713.jar tmpDir=null
 1 b'20/06/17 21:18:26 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:18:27 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:18:27 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:18:27 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:18:27 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:18:27 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0067\n20/06/17 21:18:27 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0067\n20/06/17 21:18:27 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0067/\n20/06/17 21:18:27 INFO mapreduce.Job: Running job: job_1592405789799_0067\n20/06/17 21:18:32 INFO mapreduce.Job: Job job_1592405789799_0067 running in uber mode : false\n20/06/17 21:18:32 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:18:37 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:38 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:42 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:43 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:48 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:49 INFO mapreduce.Job: Task Id : attempt_1592405789799_0067_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:18:54 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:18:54 INFO mapreduce.Job: Job job_1592405789799_0067 failed with state FAILED due to: Task failed task_1592405789799_0067_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:18:54 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=25585\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=25585\n\t\tTotal vcore-seconds taken by all map tasks=25585\n\t\tTotal megabyte-seconds taken by all map tasks=26199040\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:18:54 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1588.4588012017', 'num_aligns == 10.0', 'prob1 == 1588.4588012017', "model2 == 'WAG+G'", 'length == 237.0']
Preferences: ['prob2 == 1588.4588012017', 'num_aligns == 10.0', 'prob1 == 1588.4588012017', "model2 == 'WAG+G'", 'length == 237.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6020870691661502063.jar tmpDir=null
 0 b'20/06/17 21:23:05 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:23:05 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:23:06 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:23:06 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:23:06 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:23:06 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0069\n20/06/17 21:23:06 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0069\n20/06/17 21:23:06 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0069/\n20/06/17 21:23:06 INFO mapreduce.Job: Running job: job_1592405789799_0069\n20/06/17 21:23:11 INFO mapreduce.Job: Job job_1592405789799_0069 running in uber mode : false\n20/06/17 21:23:11 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:23:16 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 21:23:17 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 21:23:22 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:23:22 INFO mapreduce.Job: Job job_1592405789799_0069 completed successfully\n20/06/17 21:23:22 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=5592\n\t\tFILE: Number of bytes written=362489\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=8347\n\t\tHDFS: Number of bytes written=5454\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6829\n\t\tTotal time spent by all reduces in occupied slots (ms)=2768\n\t\tTotal time spent by all map tasks (ms)=6829\n\t\tTotal time spent by all reduce tasks (ms)=2768\n\t\tTotal vcore-seconds taken by all map tasks=6829\n\t\tTotal vcore-seconds taken by all reduce tasks=2768\n\t\tTotal megabyte-seconds taken by all map tasks=6992896\n\t\tTotal megabyte-seconds taken by all reduce tasks=2834432\n\tMap-Reduce Framework\n\t\tMap input records=21\n\t\tMap output records=42\n\t\tMap output bytes=5478\n\t\tMap output materialized bytes=5598\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=22\n\t\tReduce shuffle bytes=5598\n\t\tReduce input records=42\n\t\tReduce output records=42\n\t\tSpilled Records=84\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=48\n\t\tCPU time spent (ms)=1390\n\t\tPhysical memory (bytes) snapshot=761110528\n\t\tVirtual memory (bytes) snapshot=4145197056\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=8117\n\tFile Output Format Counters \n\t\tBytes Written=5454\n20/06/17 21:23:22 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6020870691661502063.jar tmpDir=null
 0 b'20/06/17 21:23:05 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:23:05 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:23:06 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:23:06 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:23:06 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:23:06 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0069\n20/06/17 21:23:06 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0069\n20/06/17 21:23:06 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0069/\n20/06/17 21:23:06 INFO mapreduce.Job: Running job: job_1592405789799_0069\n20/06/17 21:23:11 INFO mapreduce.Job: Job job_1592405789799_0069 running in uber mode : false\n20/06/17 21:23:11 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:23:16 INFO mapreduce.Job:  map 50% reduce 0%\n20/06/17 21:23:17 INFO mapreduce.Job:  map 100% reduce 0%\n20/06/17 21:23:22 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:23:22 INFO mapreduce.Job: Job job_1592405789799_0069 completed successfully\n20/06/17 21:23:22 INFO mapreduce.Job: Counters: 49\n\tFile System Counters\n\t\tFILE: Number of bytes read=5592\n\t\tFILE: Number of bytes written=362489\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=8347\n\t\tHDFS: Number of bytes written=5454\n\t\tHDFS: Number of read operations=9\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=2\n\t\tLaunched reduce tasks=1\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=6829\n\t\tTotal time spent by all reduces in occupied slots (ms)=2768\n\t\tTotal time spent by all map tasks (ms)=6829\n\t\tTotal time spent by all reduce tasks (ms)=2768\n\t\tTotal vcore-seconds taken by all map tasks=6829\n\t\tTotal vcore-seconds taken by all reduce tasks=2768\n\t\tTotal megabyte-seconds taken by all map tasks=6992896\n\t\tTotal megabyte-seconds taken by all reduce tasks=2834432\n\tMap-Reduce Framework\n\t\tMap input records=21\n\t\tMap output records=42\n\t\tMap output bytes=5478\n\t\tMap output materialized bytes=5598\n\t\tInput split bytes=230\n\t\tCombine input records=0\n\t\tCombine output records=0\n\t\tReduce input groups=22\n\t\tReduce shuffle bytes=5598\n\t\tReduce input records=42\n\t\tReduce output records=42\n\t\tSpilled Records=84\n\t\tShuffled Maps =2\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=2\n\t\tGC time elapsed (ms)=48\n\t\tCPU time spent (ms)=1390\n\t\tPhysical memory (bytes) snapshot=761110528\n\t\tVirtual memory (bytes) snapshot=4145197056\n\t\tTotal committed heap usage (bytes)=748683264\n\tShuffle Errors\n\t\tBAD_ID=0\n\t\tCONNECTION=0\n\t\tIO_ERROR=0\n\t\tWRONG_LENGTH=0\n\t\tWRONG_MAP=0\n\t\tWRONG_REDUCE=0\n\tFile Input Format Counters \n\t\tBytes Read=8117\n\tFile Output Format Counters \n\t\tBytes Written=5454\n20/06/17 21:23:22 INFO streaming.StreamJob: Output directory: /user/freep/output\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['num_aligns == 10.0', 'length == 230.0', 'prob1 == 1651.09950169048', 'prob2 == 1651.09950169048', "model2 == 'WAG+G'"]
Preferences: ['num_aligns == 10.0', 'length == 230.0', 'prob1 == 1651.09950169048', 'prob2 == 1651.09950169048', "model2 == 'WAG+G'"]
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1520887577391674170.jar tmpDir=null
 1 b'20/06/17 21:26:11 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:26:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:26:12 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:26:12 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:26:12 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:26:12 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0071\n20/06/17 21:26:12 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0071\n20/06/17 21:26:12 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0071/\n20/06/17 21:26:12 INFO mapreduce.Job: Running job: job_1592405789799_0071\n20/06/17 21:26:16 INFO mapreduce.Job: Job job_1592405789799_0071 running in uber mode : false\n20/06/17 21:26:16 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:26:21 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:22 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:26 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:27 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:32 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:34 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:39 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:26:39 INFO mapreduce.Job: Job job_1592405789799_0071 failed with state FAILED due to: Task failed task_1592405789799_0071_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:26:39 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=29189\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=29189\n\t\tTotal vcore-seconds taken by all map tasks=29189\n\t\tTotal megabyte-seconds taken by all map tasks=29889536\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:26:39 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1520887577391674170.jar tmpDir=null
 1 b'20/06/17 21:26:11 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:26:11 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:26:12 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:26:12 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:26:12 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:26:12 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0071\n20/06/17 21:26:12 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0071\n20/06/17 21:26:12 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0071/\n20/06/17 21:26:12 INFO mapreduce.Job: Running job: job_1592405789799_0071\n20/06/17 21:26:16 INFO mapreduce.Job: Job job_1592405789799_0071 running in uber mode : false\n20/06/17 21:26:16 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:26:21 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:22 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:26 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:27 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:32 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:34 INFO mapreduce.Job: Task Id : attempt_1592405789799_0071_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:26:39 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:26:39 INFO mapreduce.Job: Job job_1592405789799_0071 failed with state FAILED due to: Task failed task_1592405789799_0071_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:26:39 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=29189\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=29189\n\t\tTotal vcore-seconds taken by all map tasks=29189\n\t\tTotal megabyte-seconds taken by all map tasks=29889536\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:26:39 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1388.3251454325', 'length == 207.0', 'prob1 == 1341.96536340936', "model2 == 'CPREV'", 'num_aligns == 10.0']
Preferences: ['prob2 == 1388.3251454325', 'length == 207.0', 'prob1 == 1341.96536340936', "model2 == 'CPREV'", 'num_aligns == 10.0']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['num_aligns == 10.0', 'length == 253.0', 'prob1 == 1715.66372694917', "model2 == 'BLOSUM62+G'", 'prob2 == 1740.86143075488']
Preferences: ['num_aligns == 10.0', 'length == 253.0', 'prob1 == 1715.66372694917', "model2 == 'BLOSUM62+G'", 'prob2 == 1740.86143075488']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob2158933812624632184.jar tmpDir=null
 1 b'20/06/17 21:34:51 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:34:52 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:34:52 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:34:52 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:34:53 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:34:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0074\n20/06/17 21:34:53 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0074\n20/06/17 21:34:53 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0074/\n20/06/17 21:34:53 INFO mapreduce.Job: Running job: job_1592405789799_0074\n20/06/17 21:34:58 INFO mapreduce.Job: Job job_1592405789799_0074 running in uber mode : false\n20/06/17 21:34:58 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:35:03 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:10 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:18 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:24 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:35:24 INFO mapreduce.Job: Job job_1592405789799_0074 failed with state FAILED due to: Task failed task_1592405789799_0074_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:35:24 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=34137\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=34137\n\t\tTotal vcore-seconds taken by all map tasks=34137\n\t\tTotal megabyte-seconds taken by all map tasks=34956288\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:35:24 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob2158933812624632184.jar tmpDir=null
 1 b'20/06/17 21:34:51 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:34:52 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:34:52 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:34:52 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:34:53 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:34:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0074\n20/06/17 21:34:53 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0074\n20/06/17 21:34:53 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0074/\n20/06/17 21:34:53 INFO mapreduce.Job: Running job: job_1592405789799_0074\n20/06/17 21:34:58 INFO mapreduce.Job: Job job_1592405789799_0074 running in uber mode : false\n20/06/17 21:34:58 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:35:03 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:10 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:18 INFO mapreduce.Job: Task Id : attempt_1592405789799_0074_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:35:24 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:35:24 INFO mapreduce.Job: Job job_1592405789799_0074 failed with state FAILED due to: Task failed task_1592405789799_0074_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:35:24 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=34137\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=34137\n\t\tTotal vcore-seconds taken by all map tasks=34137\n\t\tTotal megabyte-seconds taken by all map tasks=34956288\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:35:24 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 804.952769924155', 'prob2 == 804.952769924155', "model2 == 'VT+G'", 'num_aligns == 10.0', 'length == 125.0']
Preferences: ['prob1 == 804.952769924155', 'prob2 == 804.952769924155', "model2 == 'VT+G'", 'num_aligns == 10.0', 'length == 125.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob387214924885958615.jar tmpDir=null
 1 b'20/06/17 21:42:51 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:42:53 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:42:53 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:42:54 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:42:54 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:42:54 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0076\n20/06/17 21:42:54 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0076\n20/06/17 21:42:54 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0076/\n20/06/17 21:42:54 INFO mapreduce.Job: Running job: job_1592405789799_0076\n20/06/17 21:43:01 INFO mapreduce.Job: Job job_1592405789799_0076 running in uber mode : false\n20/06/17 21:43:01 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:43:08 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:14 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:22 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:23 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:31 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:43:32 INFO mapreduce.Job: Job job_1592405789799_0076 failed with state FAILED due to: Task failed task_1592405789799_0076_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:43:32 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=43105\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=43105\n\t\tTotal vcore-seconds taken by all map tasks=43105\n\t\tTotal megabyte-seconds taken by all map tasks=44139520\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:43:32 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob387214924885958615.jar tmpDir=null
 1 b'20/06/17 21:42:51 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:42:53 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:42:53 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:42:54 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:42:54 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:42:54 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0076\n20/06/17 21:42:54 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0076\n20/06/17 21:42:54 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0076/\n20/06/17 21:42:54 INFO mapreduce.Job: Running job: job_1592405789799_0076\n20/06/17 21:43:01 INFO mapreduce.Job: Job job_1592405789799_0076 running in uber mode : false\n20/06/17 21:43:01 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:43:08 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:14 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:22 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:23 INFO mapreduce.Job: Task Id : attempt_1592405789799_0076_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:43:31 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:43:32 INFO mapreduce.Job: Job job_1592405789799_0076 failed with state FAILED due to: Task failed task_1592405789799_0076_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:43:32 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=43105\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=43105\n\t\tTotal vcore-seconds taken by all map tasks=43105\n\t\tTotal megabyte-seconds taken by all map tasks=44139520\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:43:32 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 3877.20299959305', 'num_aligns == 10.0', 'prob2 == 3877.20299959305', 'length == 496.0', "model2 == 'RtREV+G+F'"]
Preferences: ['prob1 == 3877.20299959305', 'num_aligns == 10.0', 'prob2 == 3877.20299959305', 'length == 496.0', "model2 == 'RtREV+G+F'"]
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob4615943811294062243.jar tmpDir=null
 1 b'20/06/17 21:48:48 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:48:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:48:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:48:51 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:48:51 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:48:51 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0078\n20/06/17 21:48:51 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0078\n20/06/17 21:48:51 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0078/\n20/06/17 21:48:51 INFO mapreduce.Job: Running job: job_1592405789799_0078\n20/06/17 21:48:58 INFO mapreduce.Job: Job job_1592405789799_0078 running in uber mode : false\n20/06/17 21:48:58 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:49:03 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:11 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:17 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:23 INFO mapreduce.Job:  map 50% reduce 100%\n20/06/17 21:49:24 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:49:24 INFO mapreduce.Job: Job job_1592405789799_0078 failed with state FAILED due to: Task failed task_1592405789799_0078_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:49:24 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=38371\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=38371\n\t\tTotal vcore-seconds taken by all map tasks=38371\n\t\tTotal megabyte-seconds taken by all map tasks=39291904\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:49:24 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob4615943811294062243.jar tmpDir=null
 1 b'20/06/17 21:48:48 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:48:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:48:50 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:48:51 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:48:51 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:48:51 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0078\n20/06/17 21:48:51 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0078\n20/06/17 21:48:51 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0078/\n20/06/17 21:48:51 INFO mapreduce.Job: Running job: job_1592405789799_0078\n20/06/17 21:48:58 INFO mapreduce.Job: Job job_1592405789799_0078 running in uber mode : false\n20/06/17 21:48:58 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:49:03 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:11 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:17 INFO mapreduce.Job: Task Id : attempt_1592405789799_0078_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:49:23 INFO mapreduce.Job:  map 50% reduce 100%\n20/06/17 21:49:24 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:49:24 INFO mapreduce.Job: Job job_1592405789799_0078 failed with state FAILED due to: Task failed task_1592405789799_0078_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:49:24 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=38371\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=38371\n\t\tTotal vcore-seconds taken by all map tasks=38371\n\t\tTotal megabyte-seconds taken by all map tasks=39291904\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:49:24 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ["model2 == 'WAG+G'", 'prob1 == 1588.4588012017', 'prob2 == 1588.4588012017', 'num_aligns == 10.0', 'length == 237.0']
Preferences: ["model2 == 'WAG+G'", 'prob1 == 1588.4588012017', 'prob2 == 1588.4588012017', 'num_aligns == 10.0', 'length == 237.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob7611179474132104515.jar tmpDir=null
 1 b'20/06/17 21:50:46 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:50:47 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:50:47 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:50:48 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:50:48 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:50:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0080\n20/06/17 21:50:49 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0080\n20/06/17 21:50:49 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0080/\n20/06/17 21:50:49 INFO mapreduce.Job: Running job: job_1592405789799_0080\n20/06/17 21:50:55 INFO mapreduce.Job: Job job_1592405789799_0080 running in uber mode : false\n20/06/17 21:50:55 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:51:01 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:02 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:08 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:22 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:51:22 INFO mapreduce.Job: Job job_1592405789799_0080 failed with state FAILED due to: Task failed task_1592405789799_0080_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:51:22 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=38581\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=38581\n\t\tTotal vcore-seconds taken by all map tasks=38581\n\t\tTotal megabyte-seconds taken by all map tasks=39506944\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:51:22 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob7611179474132104515.jar tmpDir=null
 1 b'20/06/17 21:50:46 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:50:47 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:50:47 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:50:48 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:50:48 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:50:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0080\n20/06/17 21:50:49 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0080\n20/06/17 21:50:49 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0080/\n20/06/17 21:50:49 INFO mapreduce.Job: Running job: job_1592405789799_0080\n20/06/17 21:50:55 INFO mapreduce.Job: Job job_1592405789799_0080 running in uber mode : false\n20/06/17 21:50:55 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:51:01 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:02 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:08 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:09 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:15 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:16 INFO mapreduce.Job: Task Id : attempt_1592405789799_0080_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:51:22 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:51:22 INFO mapreduce.Job: Job job_1592405789799_0080 failed with state FAILED due to: Task failed task_1592405789799_0080_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:51:22 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=38581\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=38581\n\t\tTotal vcore-seconds taken by all map tasks=38581\n\t\tTotal megabyte-seconds taken by all map tasks=39506944\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:51:22 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['num_aligns == 9.0', 'prob1 == 5633.46110822571', 'length == 697.0', 'prob2 == 5633.46110822571', "model2 == 'WAG+I+F'"]
Preferences: ['num_aligns == 9.0', 'prob1 == 5633.46110822571', 'length == 697.0', 'prob2 == 5633.46110822571', "model2 == 'WAG+I+F'"]
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6086558258776477542.jar tmpDir=null
 1 b'20/06/17 21:55:27 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:55:28 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:55:28 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:55:29 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:55:29 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:55:29 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0082\n20/06/17 21:55:29 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0082\n20/06/17 21:55:29 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0082/\n20/06/17 21:55:29 INFO mapreduce.Job: Running job: job_1592405789799_0082\n20/06/17 21:55:36 INFO mapreduce.Job: Job job_1592405789799_0082 running in uber mode : false\n20/06/17 21:55:36 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:55:42 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:43 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:49 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:50 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:56 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:57 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:56:04 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:56:04 INFO mapreduce.Job: Job job_1592405789799_0082 failed with state FAILED due to: Task failed task_1592405789799_0082_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:56:04 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=39807\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=39807\n\t\tTotal vcore-seconds taken by all map tasks=39807\n\t\tTotal megabyte-seconds taken by all map tasks=40762368\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:56:04 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6086558258776477542.jar tmpDir=null
 1 b'20/06/17 21:55:27 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:55:28 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:55:28 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:55:29 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:55:29 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:55:29 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0082\n20/06/17 21:55:29 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0082\n20/06/17 21:55:29 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0082/\n20/06/17 21:55:29 INFO mapreduce.Job: Running job: job_1592405789799_0082\n20/06/17 21:55:36 INFO mapreduce.Job: Job job_1592405789799_0082 running in uber mode : false\n20/06/17 21:55:36 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:55:42 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:43 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:49 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:50 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:56 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:55:57 INFO mapreduce.Job: Task Id : attempt_1592405789799_0082_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:56:04 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:56:04 INFO mapreduce.Job: Job job_1592405789799_0082 failed with state FAILED due to: Task failed task_1592405789799_0082_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:56:04 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=39807\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=39807\n\t\tTotal vcore-seconds taken by all map tasks=39807\n\t\tTotal megabyte-seconds taken by all map tasks=40762368\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:56:04 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob1 == 1588.4588012017', 'prob2 == 1588.4588012017', 'num_aligns == 10.0', 'length == 237.0', "model2 == 'WAG+G'"]
Preferences: ['prob1 == 1588.4588012017', 'prob2 == 1588.4588012017', 'num_aligns == 10.0', 'length == 237.0', "model2 == 'WAG+G'"]
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6325935645309096252.jar tmpDir=null
 1 b'20/06/17 21:56:41 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:56:42 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:56:43 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:56:44 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:56:44 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:56:44 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0084\n20/06/17 21:56:44 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0084\n20/06/17 21:56:44 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0084/\n20/06/17 21:56:44 INFO mapreduce.Job: Running job: job_1592405789799_0084\n20/06/17 21:56:51 INFO mapreduce.Job: Job job_1592405789799_0084 running in uber mode : false\n20/06/17 21:56:51 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:56:57 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:56:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:03 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:04 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:11 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:18 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:57:18 INFO mapreduce.Job: Job job_1592405789799_0084 failed with state FAILED due to: Task failed task_1592405789799_0084_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:57:18 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=40189\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=40189\n\t\tTotal vcore-seconds taken by all map tasks=40189\n\t\tTotal megabyte-seconds taken by all map tasks=41153536\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:57:18 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6325935645309096252.jar tmpDir=null
 1 b'20/06/17 21:56:41 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:56:42 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:56:43 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:56:44 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:56:44 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:56:44 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0084\n20/06/17 21:56:44 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0084\n20/06/17 21:56:44 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0084/\n20/06/17 21:56:44 INFO mapreduce.Job: Running job: job_1592405789799_0084\n20/06/17 21:56:51 INFO mapreduce.Job: Job job_1592405789799_0084 running in uber mode : false\n20/06/17 21:56:51 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:56:57 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:56:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:03 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:04 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:11 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0084_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:57:18 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:57:18 INFO mapreduce.Job: Job job_1592405789799_0084 failed with state FAILED due to: Task failed task_1592405789799_0084_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:57:18 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=40189\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=40189\n\t\tTotal vcore-seconds taken by all map tasks=40189\n\t\tTotal megabyte-seconds taken by all map tasks=41153536\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:57:18 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['num_aligns == 10.0', "model2 == 'BLOSUM62+I'", 'prob2 == 2481.11600875964', 'length == 223.0', 'prob1 == 2481.11600875964']
Preferences: ['num_aligns == 10.0', "model2 == 'BLOSUM62+I'", 'prob2 == 2481.11600875964', 'length == 223.0', 'prob1 == 2481.11600875964']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1519744203818350085.jar tmpDir=null
 1 b'20/06/17 21:58:43 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:58:44 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:58:44 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:58:45 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:58:45 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:58:45 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0086\n20/06/17 21:58:45 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0086\n20/06/17 21:58:45 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0086/\n20/06/17 21:58:45 INFO mapreduce.Job: Running job: job_1592405789799_0086\n20/06/17 21:58:51 INFO mapreduce.Job: Job job_1592405789799_0086 running in uber mode : false\n20/06/17 21:58:51 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:58:57 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:58:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:04 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:20 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:59:20 INFO mapreduce.Job: Job job_1592405789799_0086 failed with state FAILED due to: Task failed task_1592405789799_0086_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:59:21 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=40428\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=40428\n\t\tTotal vcore-seconds taken by all map tasks=40428\n\t\tTotal megabyte-seconds taken by all map tasks=41398272\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:59:21 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob1519744203818350085.jar tmpDir=null
 1 b'20/06/17 21:58:43 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/17 21:58:44 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:58:44 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/17 21:58:45 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/17 21:58:45 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/17 21:58:45 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1592405789799_0086\n20/06/17 21:58:45 INFO impl.YarnClientImpl: Submitted application application_1592405789799_0086\n20/06/17 21:58:45 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1592405789799_0086/\n20/06/17 21:58:45 INFO mapreduce.Job: Running job: job_1592405789799_0086\n20/06/17 21:58:51 INFO mapreduce.Job: Job job_1592405789799_0086 running in uber mode : false\n20/06/17 21:58:51 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/17 21:58:57 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:58:58 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:04 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:05 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:12 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:13 INFO mapreduce.Job: Task Id : attempt_1592405789799_0086_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/17 21:59:20 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/17 21:59:20 INFO mapreduce.Job: Job job_1592405789799_0086 failed with state FAILED due to: Task failed task_1592405789799_0086_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/17 21:59:21 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=40428\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=40428\n\t\tTotal vcore-seconds taken by all map tasks=40428\n\t\tTotal megabyte-seconds taken by all map tasks=41398272\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/17 21:59:21 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['num_aligns == 10.0', 'length == 237.0', "model2 == 'WAG+G'", 'prob1 == 1588.4588012017', 'prob2 == 1588.4588012017']
Preferences: ['num_aligns == 10.0', 'length == 237.0', "model2 == 'WAG+G'", 'prob1 == 1588.4588012017', 'prob2 == 1588.4588012017']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob4008730224531725005.jar tmpDir=null
 1 b'20/06/24 15:32:06 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/24 15:32:07 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/24 15:32:07 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/24 15:32:08 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/24 15:32:08 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/24 15:32:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1593012393968_0002\n20/06/24 15:32:08 INFO impl.YarnClientImpl: Submitted application application_1593012393968_0002\n20/06/24 15:32:08 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1593012393968_0002/\n20/06/24 15:32:08 INFO mapreduce.Job: Running job: job_1593012393968_0002\n20/06/24 15:32:13 INFO mapreduce.Job: Job job_1593012393968_0002 running in uber mode : false\n20/06/24 15:32:13 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/24 15:32:17 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:18 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:21 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:22 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:26 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:27 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:31 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/24 15:32:31 INFO mapreduce.Job: Job job_1593012393968_0002 failed with state FAILED due to: Task failed task_1593012393968_0002_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/24 15:32:31 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=22374\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=22374\n\t\tTotal vcore-seconds taken by all map tasks=22374\n\t\tTotal megabyte-seconds taken by all map tasks=22910976\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/24 15:32:31 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob4008730224531725005.jar tmpDir=null
 1 b'20/06/24 15:32:06 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/06/24 15:32:07 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/24 15:32:07 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/06/24 15:32:08 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/06/24 15:32:08 INFO mapreduce.JobSubmitter: number of splits:2\n20/06/24 15:32:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1593012393968_0002\n20/06/24 15:32:08 INFO impl.YarnClientImpl: Submitted application application_1593012393968_0002\n20/06/24 15:32:08 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1593012393968_0002/\n20/06/24 15:32:08 INFO mapreduce.Job: Running job: job_1593012393968_0002\n20/06/24 15:32:13 INFO mapreduce.Job: Job job_1593012393968_0002 running in uber mode : false\n20/06/24 15:32:13 INFO mapreduce.Job:  map 0% reduce 0%\n20/06/24 15:32:17 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:18 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:21 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:22 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:26 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:27 INFO mapreduce.Job: Task Id : attempt_1593012393968_0002_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/06/24 15:32:31 INFO mapreduce.Job:  map 100% reduce 100%\n20/06/24 15:32:31 INFO mapreduce.Job: Job job_1593012393968_0002 failed with state FAILED due to: Task failed task_1593012393968_0002_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/06/24 15:32:31 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=22374\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=22374\n\t\tTotal vcore-seconds taken by all map tasks=22374\n\t\tTotal megabyte-seconds taken by all map tasks=22910976\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/06/24 15:32:31 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['length == 237.0', "model2 == 'WAG+G'", 'prob2 == 1588.4588012017', 'num_aligns == 10.0', 'prob1 == 1588.4588012017']
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob5268291205314418330.jar tmpDir=null
 1 b'20/09/16 18:28:30 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 18:28:31 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 18:28:31 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 18:28:32 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/09/16 18:28:33 INFO mapreduce.JobSubmitter: number of splits:2\n20/09/16 18:28:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1600279159555_0004\n20/09/16 18:28:33 INFO impl.YarnClientImpl: Submitted application application_1600279159555_0004\n20/09/16 18:28:33 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1600279159555_0004/\n20/09/16 18:28:33 INFO mapreduce.Job: Running job: job_1600279159555_0004\n20/09/16 18:28:38 INFO mapreduce.Job: Job job_1600279159555_0004 running in uber mode : false\n20/09/16 18:28:38 INFO mapreduce.Job:  map 0% reduce 0%\n20/09/16 18:28:42 INFO mapreduce.Job: Task Id : attempt_1600279159555_0004_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:28:43 INFO mapreduce.Job: Task Id : attempt_1600279159555_0004_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:28:46 INFO mapreduce.Job: Task Id : attempt_1600279159555_0004_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:28:47 INFO mapreduce.Job: Task Id : attempt_1600279159555_0004_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:28:51 INFO mapreduce.Job: Task Id : attempt_1600279159555_0004_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:28:52 INFO mapreduce.Job: Task Id : attempt_1600279159555_0004_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:28:56 INFO mapreduce.Job:  map 100% reduce 100%\n20/09/16 18:28:57 INFO mapreduce.Job: Job job_1600279159555_0004 failed with state FAILED due to: Task failed task_1600279159555_0004_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/09/16 18:28:57 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=22111\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=22111\n\t\tTotal vcore-seconds taken by all map tasks=22111\n\t\tTotal megabyte-seconds taken by all map tasks=22641664\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/09/16 18:28:57 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['prob1 == 1588.4588012017', 'prob2 == 1588.4588012017', 'length == 237.0', 'num_aligns == 10.0', "model2 == 'WAG+G'"]
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob8166317194395602958.jar tmpDir=null
 1 b'20/09/16 18:47:39 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 18:47:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 18:47:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 18:47:41 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/09/16 18:47:42 INFO mapreduce.JobSubmitter: number of splits:2\n20/09/16 18:47:42 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1600279159555_0006\n20/09/16 18:47:42 INFO impl.YarnClientImpl: Submitted application application_1600279159555_0006\n20/09/16 18:47:42 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1600279159555_0006/\n20/09/16 18:47:42 INFO mapreduce.Job: Running job: job_1600279159555_0006\n20/09/16 18:47:47 INFO mapreduce.Job: Job job_1600279159555_0006 running in uber mode : false\n20/09/16 18:47:47 INFO mapreduce.Job:  map 0% reduce 0%\n20/09/16 18:47:51 INFO mapreduce.Job: Task Id : attempt_1600279159555_0006_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:47:52 INFO mapreduce.Job: Task Id : attempt_1600279159555_0006_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:47:56 INFO mapreduce.Job: Task Id : attempt_1600279159555_0006_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:47:57 INFO mapreduce.Job: Task Id : attempt_1600279159555_0006_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:48:01 INFO mapreduce.Job: Task Id : attempt_1600279159555_0006_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:48:02 INFO mapreduce.Job: Task Id : attempt_1600279159555_0006_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 18:48:06 INFO mapreduce.Job:  map 100% reduce 100%\n20/09/16 18:48:06 INFO mapreduce.Job: Job job_1600279159555_0006 failed with state FAILED due to: Task failed task_1600279159555_0006_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/09/16 18:48:06 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=21403\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=21403\n\t\tTotal vcore-seconds taken by all map tasks=21403\n\t\tTotal megabyte-seconds taken by all map tasks=21916672\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/09/16 18:48:06 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Recriando diretórios...
Copiando dados para HDFS...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela ORC...
Realizando consulta...
('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')
Transferindo dados...
Realizando consulta...
[('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False'), ('10.0', '237.0', 'WAG+G', '1588.4588012017', 'WAG+G', '1588.4588012017', 'False')]
Finalizando...
Target: model1
Preferences: ['num_aligns == 10.0', 'prob1 == 1123.66070728824', "model2 == 'RtREV+G'", 'prob2 == 1123.66070728824', 'length == 159.0']
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob2726104252756424226.jar tmpDir=null
 1 b'20/09/16 19:06:48 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 19:06:48 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:06:48 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:06:49 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/09/16 19:06:50 INFO mapreduce.JobSubmitter: number of splits:2\n20/09/16 19:06:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1600279159555_0008\n20/09/16 19:06:50 INFO impl.YarnClientImpl: Submitted application application_1600279159555_0008\n20/09/16 19:06:50 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1600279159555_0008/\n20/09/16 19:06:50 INFO mapreduce.Job: Running job: job_1600279159555_0008\n20/09/16 19:06:55 INFO mapreduce.Job: Job job_1600279159555_0008 running in uber mode : false\n20/09/16 19:06:55 INFO mapreduce.Job:  map 0% reduce 0%\n20/09/16 19:06:59 INFO mapreduce.Job: Task Id : attempt_1600279159555_0008_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:07:00 INFO mapreduce.Job: Task Id : attempt_1600279159555_0008_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:07:04 INFO mapreduce.Job: Task Id : attempt_1600279159555_0008_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:07:05 INFO mapreduce.Job: Task Id : attempt_1600279159555_0008_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:07:11 INFO mapreduce.Job: Task Id : attempt_1600279159555_0008_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:07:12 INFO mapreduce.Job: Task Id : attempt_1600279159555_0008_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:07:16 INFO mapreduce.Job:  map 100% reduce 100%\n20/09/16 19:07:17 INFO mapreduce.Job: Job job_1600279159555_0008 failed with state FAILED due to: Task failed task_1600279159555_0008_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/09/16 19:07:17 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=23116\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=23116\n\t\tTotal vcore-seconds taken by all map tasks=23116\n\t\tTotal megabyte-seconds taken by all map tasks=23670784\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/09/16 19:07:17 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ["model2 == 'WAG+I'", 'length == 339.0', 'prob1 == 2012.68124743812', 'num_aligns == 11.0', 'prob2 == 2052.86464998793']
Preferences: ["model2 == 'WAG+I'", 'length == 339.0', 'prob1 == 2012.68124743812', 'num_aligns == 11.0', 'prob2 == 2052.86464998793']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob4456137326963699852.jar tmpDir=null
 1 b'20/09/16 19:08:19 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 19:08:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:08:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:08:20 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/09/16 19:08:21 INFO mapreduce.JobSubmitter: number of splits:2\n20/09/16 19:08:21 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1600279159555_0010\n20/09/16 19:08:21 INFO impl.YarnClientImpl: Submitted application application_1600279159555_0010\n20/09/16 19:08:21 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1600279159555_0010/\n20/09/16 19:08:21 INFO mapreduce.Job: Running job: job_1600279159555_0010\n20/09/16 19:08:26 INFO mapreduce.Job: Job job_1600279159555_0010 running in uber mode : false\n20/09/16 19:08:26 INFO mapreduce.Job:  map 0% reduce 0%\n20/09/16 19:08:30 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:31 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:35 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:37 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:41 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:42 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:46 INFO mapreduce.Job:  map 100% reduce 100%\n20/09/16 19:08:47 INFO mapreduce.Job: Job job_1600279159555_0010 failed with state FAILED due to: Task failed task_1600279159555_0010_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/09/16 19:08:47 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=23979\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=23979\n\t\tTotal vcore-seconds taken by all map tasks=23979\n\t\tTotal megabyte-seconds taken by all map tasks=24554496\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/09/16 19:08:47 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob4456137326963699852.jar tmpDir=null
 1 b'20/09/16 19:08:19 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 19:08:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:08:19 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:08:20 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/09/16 19:08:21 INFO mapreduce.JobSubmitter: number of splits:2\n20/09/16 19:08:21 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1600279159555_0010\n20/09/16 19:08:21 INFO impl.YarnClientImpl: Submitted application application_1600279159555_0010\n20/09/16 19:08:21 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1600279159555_0010/\n20/09/16 19:08:21 INFO mapreduce.Job: Running job: job_1600279159555_0010\n20/09/16 19:08:26 INFO mapreduce.Job: Job job_1600279159555_0010 running in uber mode : false\n20/09/16 19:08:26 INFO mapreduce.Job:  map 0% reduce 0%\n20/09/16 19:08:30 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:31 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:35 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:37 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:41 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:42 INFO mapreduce.Job: Task Id : attempt_1600279159555_0010_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:08:46 INFO mapreduce.Job:  map 100% reduce 100%\n20/09/16 19:08:47 INFO mapreduce.Job: Job job_1600279159555_0010 failed with state FAILED due to: Task failed task_1600279159555_0010_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/09/16 19:08:47 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=23979\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=23979\n\t\tTotal vcore-seconds taken by all map tasks=23979\n\t\tTotal megabyte-seconds taken by all map tasks=24554496\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/09/16 19:08:47 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1283.56989953363', 'num_aligns == 10.0', "model2 == 'WAG+I'", 'prob1 == 1246.4621751953', 'length == 214.0']
Preferences: ['prob2 == 1283.56989953363', 'num_aligns == 10.0', "model2 == 'WAG+I'", 'prob1 == 1246.4621751953', 'length == 214.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob5192514357106830659.jar tmpDir=null
 5 b'20/09/16 19:18:39 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 19:18:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:18:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:18:40 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/09/16 19:18:40 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/09/16 19:18:40 ERROR streaming.StreamJob: Error Launching job : Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob5192514357106830659.jar tmpDir=null
 5 b'20/09/16 19:18:39 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 19:18:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:18:40 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:18:40 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/09/16 19:18:40 WARN security.UserGroupInformation: PriviledgedActionException as:root (auth:SIMPLE) cause:org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\n20/09/16 19:18:40 ERROR streaming.StreamJob: Error Launching job : Output directory hdfs://quickstart.cloudera:8020/user/freep/output already exists\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1588.4588012017', "model2 == 'WAG+G'", 'length == 237.0', 'prob1 == 1588.4588012017', 'num_aligns == 10.0']
Preferences: ['prob2 == 1588.4588012017', "model2 == 'WAG+G'", 'length == 237.0', 'prob1 == 1588.4588012017', 'num_aligns == 10.0']
Generating partitions...
Generating partitions...
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6108073595841746215.jar tmpDir=null
 1 b'20/09/16 19:19:45 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 19:19:46 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:19:46 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:19:47 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/09/16 19:19:48 INFO mapreduce.JobSubmitter: number of splits:2\n20/09/16 19:19:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1600279159555_0014\n20/09/16 19:19:48 INFO impl.YarnClientImpl: Submitted application application_1600279159555_0014\n20/09/16 19:19:48 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1600279159555_0014/\n20/09/16 19:19:48 INFO mapreduce.Job: Running job: job_1600279159555_0014\n20/09/16 19:19:53 INFO mapreduce.Job: Job job_1600279159555_0014 running in uber mode : false\n20/09/16 19:19:53 INFO mapreduce.Job:  map 0% reduce 0%\n20/09/16 19:19:56 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:19:57 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:00 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:01 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:05 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:06 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:10 INFO mapreduce.Job:  map 100% reduce 100%\n20/09/16 19:20:11 INFO mapreduce.Job: Job job_1600279159555_0014 failed with state FAILED due to: Task failed task_1600279159555_0014_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/09/16 19:20:11 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=21522\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=21522\n\t\tTotal vcore-seconds taken by all map tasks=21522\n\t\tTotal megabyte-seconds taken by all map tasks=22038528\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/09/16 19:20:11 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Job status: packageJobJar: [/app/hadoop_study/recommender_mapper.py, /app/hadoop_study/recommender_reducer.py] [/usr/jars/hadoop-streaming-2.6.0-cdh5.7.0.jar] /tmp/streamjob6108073595841746215.jar tmpDir=null
 1 b'20/09/16 19:19:45 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.\n20/09/16 19:19:46 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:19:46 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n20/09/16 19:19:47 INFO mapred.FileInputFormat: Total input paths to process : 1\n20/09/16 19:19:48 INFO mapreduce.JobSubmitter: number of splits:2\n20/09/16 19:19:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1600279159555_0014\n20/09/16 19:19:48 INFO impl.YarnClientImpl: Submitted application application_1600279159555_0014\n20/09/16 19:19:48 INFO mapreduce.Job: The url to track the job: http://quickstart.cloudera:8088/proxy/application_1600279159555_0014/\n20/09/16 19:19:48 INFO mapreduce.Job: Running job: job_1600279159555_0014\n20/09/16 19:19:53 INFO mapreduce.Job: Job job_1600279159555_0014 running in uber mode : false\n20/09/16 19:19:53 INFO mapreduce.Job:  map 0% reduce 0%\n20/09/16 19:19:56 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000000_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:19:57 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000001_0, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:00 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000000_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:01 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000001_1, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:05 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000000_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:06 INFO mapreduce.Job: Task Id : attempt_1600279159555_0014_m_000001_2, Status : FAILED\nError: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1\n\tat org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:325)\n\tat org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:538)\n\tat org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)\n\tat org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:164)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1693)\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)\n\n20/09/16 19:20:10 INFO mapreduce.Job:  map 100% reduce 100%\n20/09/16 19:20:11 INFO mapreduce.Job: Job job_1600279159555_0014 failed with state FAILED due to: Task failed task_1600279159555_0014_m_000000\nJob failed as tasks failed. failedMaps:1 failedReduces:0\n\n20/09/16 19:20:11 INFO mapreduce.Job: Counters: 13\n\tJob Counters \n\t\tFailed map tasks=7\n\t\tKilled map tasks=1\n\t\tLaunched map tasks=8\n\t\tOther local map tasks=6\n\t\tData-local map tasks=2\n\t\tTotal time spent by all maps in occupied slots (ms)=21522\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=21522\n\t\tTotal vcore-seconds taken by all map tasks=21522\n\t\tTotal megabyte-seconds taken by all map tasks=22038528\n\tMap-Reduce Framework\n\t\tCPU time spent (ms)=0\n\t\tPhysical memory (bytes) snapshot=0\n\t\tVirtual memory (bytes) snapshot=0\n20/09/16 19:20:11 ERROR streaming.StreamJob: Job not successful!\nStreaming Command Failed!\n'
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['prob2 == 1312.58800561323', 'num_aligns == 10.0', 'length == 209.0', "model2 == 'RtREV+I'", 'prob1 == 1292.25694267618']
Preferences: ['prob2 == 1312.58800561323', 'num_aligns == 10.0', 'length == 209.0', "model2 == 'RtREV+I'", 'prob1 == 1292.25694267618']
Generating partitions...
Generating partitions...
Removendo dados de execução anterior...
Removendo dados de execução anterior...
Recriando diretórios...
Recriando diretórios...
Copiando dados para HDFS...
Copiando dados para HDFS...
Criando base no HIVE...
Criando base no HIVE...
Gerando tabela externa...
Gerando tabela externa...
Gerando tabela ORC...
Gerando tabela ORC...
Transferindo dados...
Transferindo dados...
Finalizando...
Finalizando...
Target: model1
Target: model1
Preferences: ['length == 854.0', 'num_aligns == 10.0', 'prob1 == 4634.24245921603', "model2 == 'WAG+I+F'", 'prob2 == 4634.24245921603']
Preferences: ['length == 854.0', 'num_aligns == 10.0', 'prob1 == 4634.24245921603', "model2 == 'WAG+I+F'", 'prob2 == 4634.24245921603']
Generating partitions...
Generating partitions...
